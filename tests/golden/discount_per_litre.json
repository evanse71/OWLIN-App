{
  "scenario": "per_litre_discount",
  "description": "Per-litre discount: Â£2 per litre on 12L total",
  "expected_discount": {
    "kind": "per_litre",
    "value": 2.0,
    "tolerance": 0.1
  },
  "invoice": {
    "supplier_id": "TEST_SUPPLIER",
    "invoice_date": "2024-01-15",
    "lines": [
      {
        "id": 1,
        "sku_id": "WINE_001",
        "description": "Red Wine 12x1L bottles",
        "quantity": 12.0,
        "unit_price": 2.0,
        "line_total": 20.0,
        "uom_key": "volume_l",
        "date": "2024-01-15",
        "supplier_id": "TEST_SUPPLIER",
        "ruleset_id": 1
      }
    ]
  },
  "expected_verdict": "off_contract_discount",
  "expected_flags": ["OFF_CONTRACT_DISCOUNT"],
  "test_cases": [
    {
      "name": "exact_litre_discount",
      "input": {
        "qty": 12.0,
        "unit_price": 2.0,
        "nett_value": 20.0,
        "description": "Red Wine 12x1L bottles"
      },
      "expected": {
        "discount_kind": "per_litre",
        "discount_value": 2.0,
        "residual_pennies": 0,
        "verdict": "off_contract_discount"
      }
    },
    {
      "name": "mixed_volumes",
      "input": {
        "qty": 6.0,
        "unit_price": 2.0,
        "nett_value": 10.0,
        "description": "White Wine 6x1L bottles"
      },
      "expected": {
        "discount_kind": "per_litre",
        "discount_value": 2.0,
        "residual_pennies": 0,
        "verdict": "off_contract_discount"
      }
    }
  ]
} 